---
title: 浏览器事件循环
date: 2024-05-26
cover: img/front/interview.jpg
categories:
 - 前端
tags:
 - 面试真题
description: 
---

## 什么是浏览器渲染循环

打开浏览器之后，渲染主线程会进入一个无限循环，每一次循环会检查消息队列中是否有任务存在。如果有就取出第一个任务执行，执行完成之后进入下一次循环，在这个过程中，其他所有线程可以随时向消息队列添加任务，新任务会加到消息队列的末尾，再添加新任务时，如果主线程是休眠状态，则会唤醒以继续进行循环。

使用异步的方式**使渲染主线程永不阻塞**

> 如何理解 JS 中的异步

> JS是一门单线程的语言，这是因为它运行在浏览器的渲染主线程中，而渲染主线程只有一个。
> 渲染主线程需要承担诸多的工作，包括渲染页面，执行JS，解析HTML，解析CSS都在其中运行。
> 如果使用同步的方式，在执行一些定时器，网络请求，用户点击等操作的时候渲染主线程会处于等待状态，造成页面无法更新，给用户造成卡死的现象。
> 浏览器的异步：当某些任务发生时，比如计时器，网络，事件监听，主线程将任务交给其他线程去处理，自身则理解结束该任务的执行，转而执行后续代码，当其他线程处理完该任务之后，将实现传递给该任务的回调函数包装成一个任务添加在消息队列的末尾，等待主线程调度执行。
> 在这种模式下，浏览器会永不阻塞，从而最大限度的保证了程序的流畅运行

消息队列任务的优先级

每个任务都有一个任务类型，同一个类型的任务必须在一个队列，不同类型的任务可以分属于不同的队列。在一次时间循环中，浏览器可以根据实际情况从不同的任务中取出任务执行
浏览器必须准备好一个微队列，微队列中的任务有限所有其他任务执行

js事件循环

> 事件循环是浏览器渲染主线程的工作方式
> 在页面打开的时候会开启一个死循环，每次循环都会从消息队列中取出第一个任务执行，而其他线程只需要在合适的时候将任务加入到队列末尾即可。
> 过去将消息队列简单分为宏任务和微任务，现在为了满足复杂的浏览器环境，取而代之的是一种更加灵活的处理方式
> 每个任务有不同的类型，将同类型的任务放在同一个队列中，不同的任务队列有着不同的优先级，浏览器自行决定取哪一个队列的任务，但是浏览器必须有一个微任务队列，微任务队列必须具有最高的优先级

js计时器可以做到精确计时吗

不可以，理由：

1.  计算机硬件没有原子钟，没办法做到精确计时
2.  受事件循环的影响，计时器的回调函数只能在主线程空闲时运行，因此可能带来偏差

