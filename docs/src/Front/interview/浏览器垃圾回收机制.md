## 内存泄漏

程序的运行需要内存，操作系统需要根据程序的需求，分配内存。对于持续运行的服务进程（比如浏览器），必须及时释放不再用到的内存。  
对于不再用到的内存，如果没有及时释放，就叫做内存泄漏

## 浏览器垃圾回收机制

浏览器的javascript具有自动回收机制，当浏览器运行时，会周期性的检查是否有内存不再使用，如果有，就需要将该块内存进行回收。  

浏览器垃圾回收机制有三种：

### 1. 引用计数算法
通过追踪每个对象的引用次数来管理内存，当一个对象的引用次数变为0的时候，意味着该对象不再需要，可以被清除。  

可能会产生循环引用的问题：
```javascript
function refLoop() {
  let obja = {}
  let objb = {}
  obja.b = objb
  objb.a = obja
}
```

### 2. 标记-清除算法   
分为两个标记和清除两个阶段：  

1. 标记阶段：遍历内存中所有的对象，所有还可以访问的对象都会被标记  
2. 清除阶段：遍历内存中所有对象，如果没有被标记，就会被清除

### 3. 分代式垃圾回收

标记清楚的问题是会对所有对象进行检查，一些大的，存活时间长的对象和一些小的，临时的对象检查的频率是相同的，但是对于前者并不需要频繁检查。  

将内存区分为两个部分：
1. 新生代：主要用于创建对象（相当于电脑内存），将新生代也分为两部分-使用区和空闲区  
所有新加入的对象都会被放在使用区中，当使用区快满的时候，进行一次垃圾回收，将使用区的可达对象标记，然后将使用区的标记对象复制到空闲区并进行排序（可以避免内存碎片化），然后将使用区清空，将原来的空闲区和使用区颠倒
2. 老生代，使用标记清除算法，将不可达的对象清除

